# DeepSeek API 配置指南

## 为什么需要DeepSeek API？

 爪迹星·云纪念馆使用DeepSeek API来生成个性化的AI信件。每封信都会根据：
- 宠物的基本信息（名字、品种、毛色等）
- 性格测试结果
- 宠物的独特个性特征

生成完全独特的信件内容，避免重复和模板化。

## 如何获取DeepSeek API密钥

1. 访问 [DeepSeek官网](https://platform.deepseek.com/)
2. 注册并登录账户
3. 进入API管理页面
4. 创建新的API密钥
5. 复制API密钥

## 配置步骤

### 方法一：使用环境变量文件（推荐）

1. 复制 `env_example.txt` 为 `.env`
2. 编辑 `.env` 文件，填入您的API密钥：
   ```
   DEEPSEEK_API_KEY=your_actual_api_key_here
   DEEPSEEK_API_URL=https://api.deepseek.com/v1/chat/completions
   ```

### 方法二：直接在config.py中配置

编辑 `app/config.py` 文件，修改以下行：
```python
DEEPSEEK_API_KEY = 'your_actual_api_key_here'
```

## 测试API配置

配置完成后，创建新纪念馆时：
1. 如果API配置正确，会生成个性化的AI信件
2. 如果API不可用，会自动使用改进的模板信件（仍然具有个性化特征）

## 个性化特征说明

AI信件会根据以下因素生成独特内容：

### 性格类型影响
- **内向谨慎型**：语言更加内敛、深沉
- **外向友好型**：语言更加活泼、热情
- **敏感依赖型**：语言更加细腻、情感丰富
- **独立自主型**：语言更加独立、理性

### 品种特色
- **猫**：优雅、独立、呼噜声、蹭人行为
- **狗**：忠诚、热情、摇尾巴、叼玩具
- **兔子**：温顺、蹦跳、小鼻子轻触
- **其他**：独特的个性表达

### 毛色特征
- **白色**：纯洁、雪花般美丽
- **黑色**：神秘、深邃
- **棕色**：温暖、甜蜜
- **花色**：独特花纹、个性鲜明

### 性格测试答案分析
系统会分析10道性格测试题的答案，提取：
- 社交倾向（社交性强 vs 相对独立）
- 活动水平（活泼好动 vs 安静温和）
- 情绪表达（丰富 vs 内敛）
- 环境适应（好奇 vs 谨慎）

## 故障排除

### API调用失败
如果看到"DeepSeek API调用失败"的日志：
1. 检查API密钥是否正确
2. 检查网络连接
3. 确认API配额是否充足
4. 系统会自动使用模板信件作为备选

### 信件内容重复
如果仍然出现重复内容：
1. 确保API配置正确
2. 检查性格测试是否完整完成
3. 尝试重新创建纪念馆

## 成本说明

DeepSeek API按使用量收费，每封信大约消耗：
- 输入tokens：约200-300
- 输出tokens：约400-600
- 总成本：约$0.01-0.02/封信

建议：
- 开发测试时使用模板信件
- 正式使用时配置API以获得最佳体验

