<!--pages/memorials/memorials.wxml-->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">æˆ‘çš„çºªå¿µé¦†</text>
    <text class="page-subtitle">è®°å½•æ¯ä¸€ä¸ªçè´µçš„å›å¿†</text>
  </view>
  
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading">
    <view class="loading-spinner"></view>
    <text>åŠ è½½ä¸­...</text>
  </view>
  
  <!-- ç©ºçŠ¶æ€ -->
  <view wx:elif="{{memorials.length === 0}}" class="empty-state">
    <view class="empty-icon">ğŸ›ï¸</view>
    <text class="empty-title">è¿˜æ²¡æœ‰çºªå¿µé¦†</text>
    <text class="empty-description">åˆ›å»ºä½ çš„ç¬¬ä¸€ä¸ªçºªå¿µé¦†ï¼Œè®°å½•çè´µçš„å›å¿†</text>
    <button class="btn btn-primary" bindtap="goToPersonalityTest">
      <text class="btn-icon">ğŸ›ï¸</text>
      <text class="btn-text">åˆ›å»ºçºªå¿µé¦†</text>
    </button>
  </view>
  
  <!-- çºªå¿µé¦†åˆ—è¡¨ -->
  <view wx:else class="memorials-grid">
    <view 
      wx:for="{{memorials}}" 
      wx:key="id" 
      class="memorial-card glass-card"
      bindtap="goToMemorialDetail"
      data-memorial-id="{{item.id}}"
    >
      <view class="memorial-header">
        <text class="memorial-title">{{item.pet_name || 'æœªå‘½å'}}</text>
        <view class="memorial-actions" catchtap="stopPropagation">
          <button class="action-btn edit-btn" bindtap="editMemorial" data-id="{{item.id}}">
            <text class="btn-icon">âœï¸</text>
          </button>
          <button class="action-btn share-btn" bindtap="shareMemorial" data-id="{{item.id}}">
            <text class="btn-icon">ğŸ”—</text>
          </button>
          <button class="action-btn delete-btn" bindtap="deleteMemorial" data-id="{{item.id}}">
            <text class="btn-icon">ğŸ—‘ï¸</text>
          </button>
        </view>
      </view>
      
      <view class="memorial-info">
        <view class="info-item">
          <text class="info-label">å“ç§:</text>
          <text class="info-value">{{item.species || 'æœªçŸ¥'}} {{item.breed || ''}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">æ€§åˆ«:</text>
          <text class="info-value">{{item.gender || 'æœªçŸ¥'}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">ç”Ÿæ—¥:</text>
          <text class="info-value">{{item.birth_date || 'æœªçŸ¥'}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">çºªå¿µæ—¥:</text>
          <text class="info-value">{{item.memorial_date || 'æœªçŸ¥'}}</text>
        </view>
      </view>
      
      <view class="memorial-photos">
        <image 
          wx:for="{{item.photos}}" 
          wx:for-item="photo" 
          wx:key="*this"
          wx:for-index="photoIndex"
          src="{{photo}}" 
          class="photo-thumb"
          bindtap="viewPhoto"
          data-photo="{{photo}}"
        />
        <view wx:if="{{item.photos.length > 5}}" class="photo-more">
          +{{item.photos.length - 5}}
        </view>
      </view>
      
      <view class="memorial-description">
        {{item.description || 'æš‚æ— æè¿°'}}
      </view>
      
      <view class="memorial-stats">
        <view class="stat-item">
          <text class="stat-number">{{item.photos.length}}</text>
          <text class="stat-label">ç…§ç‰‡</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{item.views || 0}}</text>
          <text class="stat-label">è®¿é—®</text>
        </view>
        <view class="stat-item">
          <text class="stat-number">{{item.likes || 0}}</text>
          <text class="stat-label">ç‚¹èµ</text>
        </view>
      </view>
    </view>
  </view>
  
  <!-- åˆ›å»ºæŒ‰é’® -->
  <view class="create-btn" bindtap="goToPersonalityTest">
    <text class="create-icon">+</text>
  </view>
</view>